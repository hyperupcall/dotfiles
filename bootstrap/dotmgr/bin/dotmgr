#!/usr/bin/env bash
set -eo pipefail

ROOT_DIR="$HOME/.dots/bootstrap/dotmgr"

source "$ROOT_DIR/lib/util.sh"

trap sigint INT
sigint() {
	die 'Received SIGINT'
}

if ((EUID == 0)); then
	die "Cannot run as root"
fi

for arg; do case "$arg" in
-h|--help)
	util.show_help
	exit
	;;
esac done

case "$1" in
bootstrap)
	shift
	source "$ROOT_DIR/lib/commands/bootstrap.sh"
	;;
module)
	shift
	source "$ROOT_DIR/lib/commands/module.sh"
	;;
module-show)
	shift
	source "$ROOT_DIR/lib/commands/module-show.sh"
	;;
maintain)
	shift
	source "$ROOT_DIR/lib/commands/maintain.sh"
	;;
import-gpgkey)
	shift
	source "$ROOT_DIR/lib/commands/import-gpgkey.sh"
	;;
*)
	log_error "No matching subcommand found"
	util.show_help
	exit 1
	;;
esac
